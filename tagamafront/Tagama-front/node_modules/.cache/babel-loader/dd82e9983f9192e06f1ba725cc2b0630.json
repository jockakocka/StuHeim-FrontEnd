{"ast":null,"code":"import { dispatchAction } from './../../index';\nimport axios from 'axios';\nexport var SERVER_API_URL = \"http://localhost:8080\"; //local npm\n//export const SERVER_API_URL =\"http://10.20.200.200:8855\"   // put server IP here                  \n\nexport function getServerApiURL() {\n  return SERVER_API_URL;\n}\nexport function getCurrentAccessToken() {\n  var idm = JSON.parse(localStorage.getItem('idm'));\n\n  if (idm != null) {\n    return idm.access_token;\n  }\n\n  dispatchAction({\n    type: \"USER_LOGOUT\",\n    payload: undefined\n  });\n  return null;\n}\nexport function getAuthorizationHeader() {\n  return \"Basic bXktdHJ1c3RlZC1jbGllbnQ6c2VjcmV0\";\n}\nexport function hasAnyRole(roles) {\n  var role = roles.split(\",\");\n  var currentRoles = localStorage.getItem('me') && JSON.parse(localStorage.getItem('me')).authorities;\n  var hasRole = false;\n\n  if (currentRoles != null) {\n    for (var i = 0; i < role.length; i++) {\n      for (var j = 0; j < currentRoles.length; j++) {\n        if (role[i] == currentRoles[j].authority) {\n          hasRole = true;\n        }\n      }\n    }\n  }\n\n  return hasRole;\n}\nexport function hasRole(roles) {\n  var role = roles.split(\",\");\n  var currentRoles = localStorage.getItem('me') && JSON.parse(localStorage.getItem('me')).authorities;\n  var hasRole = false;\n\n  if (currentRoles != null) {\n    for (var i = 0; i < role.length; i++) {\n      for (var j = 0; j < currentRoles.length; j++) {\n        if (role[i] == currentRoles[j].authority) {\n          hasRole = true;\n        }\n      }\n\n      if (hasRole == false) {\n        return false;\n      }\n\n      if (i != role.length - 1) {\n        hasRole = false;\n      }\n    }\n  }\n\n  return hasRole;\n}\nexport function handleLogout() {\n  dispatchAction({\n    type: \"USER_LOGOUT\",\n    payload: undefined\n  });\n  localStorage.removeItem('idm');\n  localStorage.removeItem('me');\n  window.location = '/login';\n  return true;\n}\nexport function refreshToken() {\n  var access_token;\n  var username;\n\n  if (localStorage.getItem('idm')) {\n    access_token = JSON.parse(localStorage.getItem('idm')).refresh_token;\n    username = JSON.parse(localStorage.getItem('idm')).username;\n  } else {\n    handleLogout();\n  }\n\n  axios({\n    url: SERVER_API_URL + '/oauth/token?refresh_token=' + JSON.parse(localStorage.getItem('idm')).refresh_token + '&grant_type=refresh_token',\n    method: 'POST',\n    headers: {\n      'Authorization': getAuthorizationHeader()\n    }\n  }).then(res => {\n    var expires_at_date = new Date(); // expires_at_date.setSeconds(expires_at_date.getSeconds() + res.data.expires_in);\n\n    expires_at_date = new Date(expires_at_date.getTime() + res.data.expires_in * 1000);\n    res.data.expires_at = expires_at_date;\n    res.data.username = username;\n    localStorage.setItem('idm', JSON.stringify(res.data));\n    return true;\n  }).catch(err => {\n    handleLogout();\n  });\n}","map":{"version":3,"sources":["C:/Users/Dell/Desktop/JovanaFiles/UniVienna/WinterSemester2020/PRAKTIKUM/tagamafront/Tagama-front/src/app/shared/app.properties.js"],"names":["dispatchAction","axios","SERVER_API_URL","getServerApiURL","getCurrentAccessToken","idm","JSON","parse","localStorage","getItem","access_token","type","payload","undefined","getAuthorizationHeader","hasAnyRole","roles","role","split","currentRoles","authorities","hasRole","i","length","j","authority","handleLogout","removeItem","window","location","refreshToken","username","refresh_token","url","method","headers","then","res","expires_at_date","Date","getTime","data","expires_in","expires_at","setItem","stringify","catch","err"],"mappings":"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","sourcesContent":["import {dispatchAction} from './../../index';\r\nimport axios from 'axios';\r\n\r\n\r\nexport const SERVER_API_URL = \"http://localhost:8080\";        //local npm\r\n//export const SERVER_API_URL =\"http://10.20.200.200:8855\"   // put server IP here                  \r\n\r\n\r\nexport function getServerApiURL() {\r\n    return SERVER_API_URL;\r\n}\r\n\r\nexport function getCurrentAccessToken(){\r\n    var idm = JSON.parse(localStorage.getItem('idm'));\r\n    if (idm != null) {\r\n        return idm.access_token;\r\n    }\r\n    dispatchAction({type: \"USER_LOGOUT\", payload: undefined});\r\n    return null;\r\n}\r\n\r\nexport function getAuthorizationHeader(){\r\n    return \"Basic bXktdHJ1c3RlZC1jbGllbnQ6c2VjcmV0\";\r\n}\r\n\r\n\r\nexport function hasAnyRole(roles) {\r\n    var role = roles.split(\",\")\r\n    var currentRoles = localStorage.getItem('me') && JSON.parse(localStorage.getItem('me')).authorities;\r\n\r\n    var hasRole = false;\r\n    if (currentRoles != null) {\r\n        for (var i = 0; i < role.length; i++) {\r\n\r\n            for (var j = 0; j < currentRoles.length; j++) {\r\n                if (role[i] == currentRoles[j].authority) {\r\n                    hasRole = true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return hasRole;\r\n}\r\n\r\nexport function hasRole(roles) {\r\n    var role = roles.split(\",\")\r\n    var currentRoles = localStorage.getItem('me') && JSON.parse(localStorage.getItem('me')).authorities;\r\n\r\n    var hasRole = false;\r\n    if (currentRoles != null) {\r\n        for (var i = 0; i < role.length; i++) {\r\n\r\n            for (var j = 0; j < currentRoles.length; j++) {\r\n                if (role[i] == currentRoles[j].authority) {\r\n                    hasRole = true;\r\n                }\r\n            }\r\n\r\n            if (hasRole == false) {\r\n                return false;\r\n            }\r\n            if (i != role.length - 1) {\r\n                hasRole = false;\r\n            }\r\n        }\r\n    }\r\n    return hasRole;\r\n}\r\n\r\nexport function handleLogout() {\r\n    dispatchAction({type: \"USER_LOGOUT\", payload: undefined});\r\n    localStorage.removeItem('idm');\r\n    localStorage.removeItem('me');\r\n    window.location = '/login';\r\n    return true;\r\n}\r\n\r\nexport function refreshToken() {\r\n    let access_token;\r\n    let username;\r\n    if (localStorage.getItem('idm')) {\r\n        access_token = JSON.parse(localStorage.getItem('idm')).refresh_token;\r\n        username = JSON.parse(localStorage.getItem('idm')).username;\r\n\r\n    } else {\r\n        handleLogout();\r\n    }\r\n    axios({\r\n        url: SERVER_API_URL + '/oauth/token?refresh_token='\r\n            + JSON.parse(localStorage.getItem('idm')).refresh_token\r\n            + '&grant_type=refresh_token',\r\n        method: 'POST',\r\n        headers: {\r\n            'Authorization': getAuthorizationHeader()\r\n        }\r\n    }).then(res => {\r\n        var expires_at_date = new Date();\r\n        // expires_at_date.setSeconds(expires_at_date.getSeconds() + res.data.expires_in);\r\n        expires_at_date = new Date(expires_at_date.getTime() + res.data.expires_in * 1000);\r\n        res.data.expires_at = expires_at_date;\r\n        res.data.username = username;\r\n        localStorage.setItem('idm', JSON.stringify(res.data));\r\n        return true;\r\n    }).catch(err => {\r\n        handleLogout();\r\n    })\r\n}\r\n"]},"metadata":{},"sourceType":"module"}